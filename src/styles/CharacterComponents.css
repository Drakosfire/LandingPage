/**
 * Character Sheet Component Styles
 * 
 * PHB-style styling for D&D 5e Character Sheets.
 * Uses .character.frame instead of .monster.frame to avoid
 * monster-specific font/styling overrides.
 * 
 * DO NOT use in StatBlockGenerator or other apps.
 * 
 * For shared D&D styling, see: styles/canvas/canvas-dnd-theme.css
 */

/* ===== Theme Layer: Character-specific decorative styles ===== */
@layer theme {

    /* ===== Character Frame (New - Replaces monster.frame for PCs) ===== */
    .page .character.frame {
        background-color: #faf2cc;
        /* Same parchment as monster */
        border: 0.5mm solid #000;
        border-radius: 4px;
        padding: 0.3cm;
        margin-bottom: 0.4cm;
        break-inside: avoid-column;
        /* Prevent mid-frame page breaks */
    }

    .page .character.frame.wide {
        column-span: all;
    }

    .page .character.frame h4 {
        font-family: 'BookInsanityRemake', serif;
        font-variant: small-caps;
        font-size: 1.1rem;
        margin: 0 0 0.3cm 0;
        border-bottom: 1px solid #d7c598;
        padding-bottom: 0.1cm;
        color: var(--dm-text-header-brown, #58180d);
    }

    .page .character.frame h5 {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.95rem;
        font-weight: bold;
        margin: 0.2cm 0 0.1cm 0;
        color: var(--dm-text-header-brown, #58180d);
    }

    /* ===== Character Name Header ===== */
    .character-name-header {
        text-align: center;
        margin-bottom: 0.4cm;
    }

    .character-name-header h1 {
        font-family: 'NodestoCapsCondensed', 'BookInsanityRemake', serif;
        font-size: 2.4rem;
        letter-spacing: 0.05em;
        margin: 0;
        line-height: 1.1;
        color: var(--dm-text-header-brown, #58180d);
    }

    .character-name-header .character-subtitle {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 1rem;
        margin: 0.2cm 0 0;
        color: var(--dm-text-dark-brown, #2b1d0f);
    }

    /* ===== Ability Score Boxes ===== */
    .ability-scores-grid {
        display: grid;
        grid-template-columns: repeat(6, 1fr);
        gap: 0.2cm;
        text-align: center;
    }

    /* Single column layout for narrow frames */
    .ability-scores-grid.vertical {
        grid-template-columns: 1fr;
        gap: 0.15cm;
    }

    .ability-box {
        border: 1px solid #000;
        border-radius: 4px;
        padding: 0.2cm;
        background: rgba(255, 255, 255, 0.5);
    }

    .ability-box .ability-label {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.7rem;
        font-weight: bold;
        text-transform: uppercase;
        color: var(--dm-text-dark-brown, #2b1d0f);
    }

    .ability-box .ability-score {
        font-family: 'BookInsanityRemake', serif;
        font-size: 1.4rem;
        font-weight: bold;
        color: var(--dm-text-dark-brown, #2b1d0f);
    }

    .ability-box .ability-modifier {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.9rem;
        color: var(--dm-text-header-brown, #58180d);
    }

    /* ===== Skills & Saves List ===== */
    .skills-list,
    .saves-list {
        list-style: none;
        padding: 0;
        margin: 0;
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.85rem;
    }

    .skills-list {
        columns: 2;
        column-gap: 0.5cm;
    }

    .saves-list {
        columns: 2;
        column-gap: 0.3cm;
    }

    .skill-item,
    .save-item {
        display: flex;
        align-items: center;
        gap: 0.2cm;
        margin-bottom: 0.12cm;
        break-inside: avoid;
    }

    .proficiency-marker {
        font-size: 0.6rem;
        width: 0.8em;
        text-align: center;
    }

    .proficiency-marker.proficient::before {
        content: '●';
    }

    .proficiency-marker:not(.proficient)::before {
        content: '○';
    }

    .skill-modifier,
    .save-modifier {
        font-weight: bold;
        min-width: 1.5em;
    }

    .skill-name,
    .save-name {
        flex: 1;
    }

    /* ===== Combat Stats Grid ===== */
    .combat-stats-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 0.3cm;
        text-align: center;
        margin-bottom: 0.3cm;
    }

    .combat-stat-box {
        border: 1px solid #000;
        border-radius: 4px;
        padding: 0.2cm;
        background: rgba(255, 255, 255, 0.3);
    }

    .combat-stat-box .stat-label {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.65rem;
        text-transform: uppercase;
        color: var(--dm-text-dark-brown, #2b1d0f);
    }

    .combat-stat-box .stat-value {
        font-family: 'BookInsanityRemake', serif;
        font-size: 1.2rem;
        font-weight: bold;
        color: var(--dm-text-header-brown, #58180d);
    }

    /* HP Box - special styling */
    .hp-box {
        display: flex;
        flex-direction: column;
        gap: 0.15cm;
    }

    .hp-current {
        font-family: 'BookInsanityRemake', serif;
        font-size: 1.5rem;
        font-weight: bold;
        color: var(--dm-text-header-brown, #58180d);
    }

    .hp-max {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.8rem;
        color: var(--dm-text-dark-brown, #2b1d0f);
    }

    .hp-temp {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.75rem;
        color: #666;
    }

    /* ===== Death Saves ===== */
    .death-saves {
        display: flex;
        gap: 0.5cm;
        justify-content: center;
        margin-top: 0.2cm;
    }

    .death-saves-group {
        display: flex;
        gap: 0.15cm;
        align-items: center;
    }

    .death-saves-label {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.7rem;
        text-transform: uppercase;
    }

    .death-save-box::before {
        content: '○';
        font-size: 0.8rem;
    }

    .death-save-box.filled::before {
        content: '●';
    }

    .death-save-box.success.filled::before {
        color: #2d5016;
    }

    .death-save-box.failure.filled::before {
        color: #9c2b1b;
    }

    /* ===== Hit Dice ===== */
    .hit-dice-display {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.85rem;
        text-align: center;
    }

    .hit-dice-value {
        font-weight: bold;
    }

    /* ===== Attacks Table ===== */
    .attacks-table {
        width: 100%;
        border-collapse: collapse;
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.8rem;
    }

    .attacks-table th {
        font-weight: bold;
        text-align: left;
        border-bottom: 1px solid #d7c598;
        padding: 0.1cm 0.2cm;
        font-size: 0.7rem;
        text-transform: uppercase;
    }

    .attacks-table td {
        padding: 0.1cm 0.2cm;
        border-bottom: 1px solid rgba(215, 197, 152, 0.5);
    }

    .attacks-table .attack-name {
        font-weight: bold;
    }

    .attacks-table .attack-bonus {
        color: var(--dm-text-header-brown, #58180d);
    }

    .attacks-table .attack-damage {
        font-weight: bold;
    }

    /* ===== Equipment List ===== */
    .equipment-list {
        list-style: none;
        padding: 0;
        margin: 0;
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.85rem;
    }

    .equipment-item {
        padding: 0.05cm 0;
        border-bottom: 1px solid rgba(215, 197, 152, 0.3);
    }

    .equipment-item:last-child {
        border-bottom: none;
    }

    .equipment-item .item-name {
        font-weight: bold;
    }

    .equipment-item .item-quantity {
        color: #666;
        font-size: 0.8rem;
    }

    /* Equipment by category */
    .equipment-category {
        margin-bottom: 0.3cm;
    }

    .equipment-category-label {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.75rem;
        font-weight: bold;
        text-transform: uppercase;
        color: var(--dm-text-header-brown, #58180d);
        margin-bottom: 0.1cm;
    }

    /* ===== Features & Traits ===== */
    .feature-item {
        margin-bottom: 0.3cm;
    }

    .feature-name {
        font-family: 'BookInsanityRemake', serif;
        font-weight: bold;
        font-style: italic;
        color: var(--dm-text-header-brown, #58180d);
    }

    .feature-description {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.85rem;
        margin-top: 0.05cm;
    }

    .feature-source {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.7rem;
        color: #666;
        font-style: italic;
    }

    /* ===== Proficiencies & Languages ===== */
    .proficiencies-section {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.85rem;
    }

    .proficiency-category {
        margin-bottom: 0.2cm;
    }

    .proficiency-label {
        font-weight: bold;
        color: var(--dm-text-header-brown, #58180d);
    }

    .proficiency-list {
        color: var(--dm-text-dark-brown, #2b1d0f);
    }

    /* ===== Background & Personality ===== */
    .personality-section {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.85rem;
    }

    .personality-trait {
        margin-bottom: 0.2cm;
    }

    .personality-label {
        font-weight: bold;
        color: var(--dm-text-header-brown, #58180d);
    }

    .personality-text {
        font-style: italic;
        color: var(--dm-text-dark-brown, #2b1d0f);
    }

    /* ===== Spell Slots Tracker ===== */
    .spell-slot-tracker {
        display: flex;
        gap: 0.15cm;
        align-items: center;
    }

    .spell-slot-level {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.8rem;
        font-weight: bold;
        min-width: 1.5em;
    }

    .spell-slot-boxes {
        display: flex;
        gap: 0.1cm;
    }

    .spell-slot::before {
        content: '□';
        font-size: 0.9rem;
    }

    .spell-slot.used::before {
        content: '■';
    }

    /* ===== Spellcasting Header ===== */
    .spellcasting-header {
        margin-bottom: 0.3cm;
    }

    .spellcasting-stats {
        display: flex;
        gap: 1cm;
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.9rem;
    }

    .spellcasting-stat {
        display: flex;
        gap: 0.2cm;
    }

    .spellcasting-stat-label {
        font-weight: bold;
    }

    .spellcasting-stat-value {
        color: var(--dm-text-header-brown, #58180d);
    }

    /* ===== Spell List (uses Homebrewery .spellList pattern) ===== */
    .character.frame .spellList {
        columns: 2;
        column-gap: 0.5cm;
    }

    .character.frame .spellList.wide {
        columns: 4;
        column-gap: 0.4cm;
    }

    .spell-level-group {
        break-inside: avoid;
        margin-bottom: 0.3cm;
    }

    .spell-level-header {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.85rem;
        font-weight: bold;
        color: var(--dm-text-header-brown, #58180d);
        border-bottom: 1px solid #d7c598;
        padding-bottom: 0.05cm;
        margin-bottom: 0.1cm;
    }

    .spell-list-items {
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.8rem;
    }

    .spell-entry {
        display: inline;
    }

    .spell-entry.prepared::after {
        content: ' ✔';
        color: #2d5016;
    }

    .spell-entry.ritual::after {
        content: ' (R)';
        font-style: italic;
        color: #666;
    }

    .spell-entry.concentration::before {
        content: '◇ ';
        color: #9c2b1b;
    }

    /* ===== Page Number Footer ===== */
    .page .page-number {
        position: absolute;
        bottom: 0.8cm;
        width: 100%;
        text-align: center;
        font-family: 'ScalySansRemake', sans-serif;
        font-size: 0.9rem;
        color: var(--dm-text-dark-brown, #2b1d0f);
    }

}

/* ===== Structure Layer: Canvas layout overrides ===== */
@layer canvas-structure {

    /* Override PHB multi-column for character frames with explicit flexbox */
    .dm-canvas-responsive .character.frame.wide {
        /* Kill CSS multi-column */
        column-count: unset;
        column-width: unset;
        column-fill: unset;

        /* Use flexbox for explicit .canvas-column children */
        display: flex;
        column-gap: var(--dm-column-gap, 12px);
        row-gap: var(--dm-column-gap, 12px);
        flex: 1 1 auto;
        width: 100%;
        max-width: 100%;
        box-sizing: border-box;
    }

    /* Measurement layer overrides */
    .dm-canvas-measurement-layer .character.frame.wide {
        transform: none;
    }

}

/* ===== Print Optimization ===== */
@media print {
    .page.phb {
        page-break-before: always;
        page-break-after: always;
    }

    .character.frame {
        break-inside: avoid;
    }

    /* Ensure backgrounds print */
    .page .character.frame {
        -webkit-print-color-adjust: exact;
        print-color-adjust: exact;
    }
}