/**
 * Canvas Base Styles
 * 
 * Universal responsive canvas container and layout patterns.
 * NO theme-specific colors or D&D-specific styling.
 * Can be used with any theme (D&D, sci-fi, modern, etc.)
 */

/* ===== CSS Variables ===== */
.dm-canvas-responsive {
    --dm-page-scale: 1;
    --dm-page-width: 816px;
    --dm-page-height: 1056px;
    --dm-column-count: 2;
    --dm-column-gap: 12px;
}

/* ===== Responsive Canvas Container ===== */
.dm-canvas-responsive {
    width: 100%;
    max-width: 100%;
    margin: 0 auto;
    padding: 0 1rem;
    box-sizing: border-box;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: flex-start;
}

/* ===== Transform Wrapper (Scaling) ===== */
.dm-canvas-wrapper {
    margin: 0;
    position: relative;
    overflow: visible;
    transition: transform 0.2s ease-out;
    /* Transform and origin are set via inline styles for precise control */
}

/* ===== Renderer Container ===== */
.dm-canvas-renderer {
    margin: 0;
    position: relative;
    overflow: visible;
    /* Width and height are set via inline styles for precise control */
}

/* ===== Page Collection ===== */
.dm-canvas-pages {
    width: var(--dm-page-width);
    position: relative;
}

.dm-canvas-pages-content {
    width: var(--dm-page-width);
    display: flex;
    flex-direction: column;
    gap: 48px;
}

/* ===== Individual Page (Uses D&D .page.phb for compatibility) ===== */
.page.phb {
    width: var(--dm-page-width);
    height: var(--dm-page-height);
    /* CSS multi-column DISABLED - Canvas uses explicit flexbox columns via .canvas-column divs */
    /* This prevents conflict with dungeonmind-canvas layout system */
}

/* ===== Canvas Page Wrapper ===== */
.dm-canvas-page {
    position: relative;
    background-repeat: no-repeat;
    background-position: center center;
    background-size: cover;
    border-radius: 6px;
}

.dm-canvas-page::before {
    content: '';
    position: absolute;
    inset: 0;
    background: rgba(255, 255, 255, 0.15);
    pointer-events: none;
}

/* ===== Column Layout ===== */
.dm-canvas-column-layout {
    position: relative;
    width: 100%;
    height: 100%;
}

.dm-canvas-component-wrapper {
    font-family: inherit;
}

/* ===== Column Wrapper (for two-column layouts) ===== */
.dm-canvas-responsive .page,
.dm-canvas-responsive .page.phb {
    column-count: unset !important;
    column-width: unset !important;
    column-gap: unset !important;
    column-fill: unset !important;
}

.dm-canvas-responsive .columnWrapper {
    display: flex;
    gap: var(--dm-column-gap, 12px);
    width: 100%;
    height: 900px;
    column-count: unset !important;
    column-width: unset !important;
    column-gap: unset !important;
    column-fill: unset !important;
}

/* CCC: Override vendor multi-column rules for shared canvas layouts */
.dm-canvas-responsive .monster.frame.wide {
    column-count: unset !important;
    column-width: unset !important;
    column-gap: unset !important;
    column-fill: unset !important;

    display: flex !important;
    gap: var(--dm-column-gap, 12px);
    flex: 1 1 auto;
    width: 100%;
    height: 100%;
    max-width: 100%;
    box-sizing: border-box;
}

/* CRITICAL: High specificity to override any other .canvas-column rules */
.dm-canvas-responsive .monster.frame.wide .canvas-column {
    /* Equal-width columns: flex distributes space evenly */
    flex: 1 1 0% !important;
    /* Equal growth/shrink, 0% basis */
    min-width: 0;
    /* Allow flex shrinking below content size */
    display: flex !important;
    flex-direction: column;
    gap: var(--dm-column-gap, 12px);
}

.dm-canvas-responsive .monster.frame.wide .canvas-column:first-of-type {
    margin-right: calc(var(--dm-column-gap, 12px) / 2);
}

.dm-canvas-responsive .monster.frame.wide .canvas-column:last-of-type {
    margin-left: calc(var(--dm-column-gap, 12px) / 2);
}

/* ===== Measurement Layer ===== */
.dm-canvas-measurement-layer {
    --dm-page-scale: 1;
}

.dm-canvas-measurement-layer .page.phb {
    transform: none !important;
    margin: 0;
}

/* ===== Responsive Breakpoints ===== */

/* Mobile phones (portrait) - Single column */
@media (max-width: 600px) {
    .page.phb {
        column-count: 1 !important;
    }
}

/* Tablets & mobile */
@media (max-width: 768px) {
    .dm-canvas-responsive {
        padding: 0 0.5rem;
    }

    .page.phb {
        font-size: 11px !important;
    }
}

/* Mobile phones */
@media (max-width: 480px) {
    .page.phb {
        font-size: 10px !important;
    }
}

/* Tablets & small desktops */
@media (max-width: 1024px) {
    .dm-canvas-responsive {
        padding: 0 0.5rem;
    }
}

/* Large desktops */
@media (min-width: 1400px) {
    .dm-canvas-responsive {
        max-width: 1200px;
    }
}

/* ===== Canvas Fallback ===== */
.dm-canvas-fallback .mantine-Text-root {
    font-family: 'ScalySansRemake', 'Open Sans', sans-serif;
}